<!--
============================================================================
MainWindow.xaml - Main Application Window
Environment Builder - Modern test environment creation tool
Evolved from TreeBuilder 3.4 by Robert Foster
============================================================================
-->
<Window x:Class="EnvironmentBuilderApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:EnvironmentBuilderApp.ViewModels"
        xmlns:local="clr-namespace:EnvironmentBuilderApp"
        mc:Ignorable="d"
        Title="Environment Builder" 
        Height="750" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="#1a1a2e">
    
    <!-- Window Icon as DrawingImage - Iconic Spartan Helmet -->
    <Window.Icon>
        <DrawingImage>
            <DrawingImage.Drawing>
                <DrawingGroup>
                    <!-- Background -->
                    <GeometryDrawing Brush="#0a0808">
                        <GeometryDrawing.Geometry>
                            <EllipseGeometry Center="64,64" RadiusX="60" RadiusY="60"/>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                    <!-- Main helmet - iconic Spartan shape -->
                    <GeometryDrawing Brush="#b8963c" Geometry="M64,12 C88,12 102,28 102,55 L102,80 L102,100 L94,118 L82,115 L78,98 L64,108 L50,98 L46,115 L34,118 L26,100 L26,80 L26,55 C26,28 40,12 64,12 Z">
                        <GeometryDrawing.Pen>
                            <Pen Brush="#8a6b20" Thickness="2"/>
                        </GeometryDrawing.Pen>
                    </GeometryDrawing>
                    <!-- T-Visor eye slit -->
                    <GeometryDrawing Brush="#0a0808" Geometry="M34,56 L94,56 L96,68 L32,68 Z"/>
                    <!-- Face opening -->
                    <GeometryDrawing Brush="#0a0808" Geometry="M48,68 L80,68 L76,95 L64,105 L52,95 Z"/>
                    <!-- Nose guard -->
                    <GeometryDrawing Brush="#c9a850" Geometry="M58,56 L70,56 L68,82 L64,88 L60,82 Z"/>
                    <!-- Tree root node -->
                    <GeometryDrawing Brush="#ff8c00">
                        <GeometryDrawing.Geometry>
                            <EllipseGeometry Center="64,32" RadiusX="5" RadiusY="5"/>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                    <!-- Tree level 1 nodes -->
                    <GeometryDrawing Brush="#ff8c00">
                        <GeometryDrawing.Geometry>
                            <EllipseGeometry Center="50,50" RadiusX="4" RadiusY="4"/>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                    <GeometryDrawing Brush="#ff8c00">
                        <GeometryDrawing.Geometry>
                            <EllipseGeometry Center="78,50" RadiusX="4" RadiusY="4"/>
                        </GeometryDrawing.Geometry>
                    </GeometryDrawing>
                </DrawingGroup>
            </DrawingImage.Drawing>
        </DrawingImage>
    </Window.Icon>
    
    <!-- Set DataContext to ViewModel -->
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>
    
    <Window.Resources>
        <!-- Color Palette - Spartan Warrior Theme -->
        <Color x:Key="PrimaryDark">#1a1a2e</Color>
        <Color x:Key="SecondaryDark">#16213e</Color>
        <Color x:Key="AccentGold">#d4a853</Color>
        <Color x:Key="AccentBronze">#b8860b</Color>
        <Color x:Key="TextLight">#e8e8e8</Color>
        <Color x:Key="TextMuted">#888888</Color>
        
        <SolidColorBrush x:Key="PrimaryDarkBrush" Color="{StaticResource PrimaryDark}"/>
        <SolidColorBrush x:Key="SecondaryDarkBrush" Color="{StaticResource SecondaryDark}"/>
        <SolidColorBrush x:Key="AccentGoldBrush" Color="{StaticResource AccentGold}"/>
        <SolidColorBrush x:Key="AccentBronzeBrush" Color="{StaticResource AccentBronze}"/>
        <SolidColorBrush x:Key="TextLightBrush" Color="{StaticResource TextLight}"/>
        <SolidColorBrush x:Key="TextMutedBrush" Color="{StaticResource TextMuted}"/>
        
        <!-- Button Style -->
        <Style x:Key="GoldButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentGoldBrush}"/>
            <Setter Property="Foreground" Value="#1a1a2e"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="4" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource AccentBronzeBrush}"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#555555"/>
                    <Setter Property="Foreground" Value="#888888"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <!-- TextBox Style -->
        <Style x:Key="DarkTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="#252545"/>
            <Setter Property="Foreground" Value="{StaticResource TextLightBrush}"/>
            <Setter Property="BorderBrush" Value="#3a3a5e"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="8,5"/>
            <Setter Property="CaretBrush" Value="{StaticResource AccentGoldBrush}"/>
        </Style>
        
        <!-- Label Style -->
        <Style x:Key="GoldLabel" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource AccentGoldBrush}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,5"/>
        </Style>
        
        <!-- TabItem Style -->
        <Style TargetType="TabItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="{StaticResource TextMutedBrush}"/>
            <Setter Property="Padding" Value="15,10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border" Background="{TemplateBinding Background}" 
                                BorderThickness="0,0,0,2" BorderBrush="Transparent"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter ContentSource="Header"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentGoldBrush}"/>
                                <Setter Property="Foreground" Value="{StaticResource AccentGoldBrush}"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="{StaticResource TextLightBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#16213e" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <!-- Iconic Spartan Helmet - Clean Silhouette -->
                    <Viewbox Width="50" Height="55" Margin="0,0,12,0">
                        <Canvas Width="100" Height="120">
                            <!-- Background circle -->
                            <Ellipse Canvas.Left="5" Canvas.Top="5" Width="90" Height="110" Fill="#0a0808"/>
                            
                            <!-- Main helmet shape - solid dark bronze -->
                            <Path Data="M50,8 
                                        C75,8 88,25 88,50 
                                        L88,75 
                                        L88,95 L80,115 L68,112 L65,95 
                                        L50,105 
                                        L35,95 L32,112 L20,115 L12,95 
                                        L12,75 
                                        L12,50 
                                        C12,25 25,8 50,8 Z" 
                                  Fill="#b8963c" Stroke="#8a6b20" StrokeThickness="2"/>
                            
                            <!-- Helmet dome highlight -->
                            <Path Data="M28,20 C38,12 62,12 72,20" 
                                  Stroke="#d4b860" StrokeThickness="2" Fill="Transparent"/>
                            <Path Data="M20,35 C20,28 30,22 42,22" 
                                  Stroke="#c9a850" StrokeThickness="1.5" Fill="Transparent"/>
                            
                            <!-- T-Visor - eye slit -->
                            <Path Data="M22,52 L78,52 L80,62 L20,62 Z" Fill="#0a0808"/>
                            
                            <!-- Nose/face opening - angular -->
                            <Path Data="M38,62 L62,62 L58,90 L50,100 L42,90 Z" Fill="#0a0808"/>
                            
                            <!-- Nose guard - center strip -->
                            <Path Data="M45,52 L55,52 L53,78 L50,85 L47,78 Z" Fill="#c9a850" Stroke="#8a6b20" StrokeThickness="1"/>
                            
                            <!-- Left eye shadow -->
                            <Path Data="M24,54 L44,54 L44,60 L22,60 Z" Fill="#050404"/>
                            <!-- Right eye shadow -->
                            <Path Data="M56,54 L76,54 L78,60 L56,60 Z" Fill="#050404"/>
                            
                            <!-- Left cheek guard edge highlight -->
                            <Path Data="M12,55 L12,90 L20,110" Stroke="#d4b860" StrokeThickness="1" Fill="Transparent"/>
                            <!-- Right cheek guard edge highlight -->
                            <Path Data="M88,55 L88,90 L80,110" Stroke="#d4b860" StrokeThickness="1" Fill="Transparent"/>
                            
                            <!-- Tree nodes - glowing thought process in forehead -->
                            <Ellipse Canvas.Left="45" Canvas.Top="22" Width="10" Height="10" Fill="#ff8c00"/>
                            <Line X1="50" Y1="32" X2="50" Y2="42" Stroke="#ff8c00" StrokeThickness="2.5"/>
                            <Line X1="50" Y1="42" X2="38" Y2="50" Stroke="#ff8c00" StrokeThickness="2"/>
                            <Line X1="50" Y1="42" X2="62" Y2="50" Stroke="#ff8c00" StrokeThickness="2"/>
                            <Ellipse Canvas.Left="33" Canvas.Top="46" Width="8" Height="8" Fill="#ff8c00"/>
                            <Ellipse Canvas.Left="59" Canvas.Top="46" Width="8" Height="8" Fill="#ff8c00"/>
                            
                            <!-- Bright node centers -->
                            <Ellipse Canvas.Left="47" Canvas.Top="24" Width="6" Height="6" Fill="#ffffaa"/>
                            <Ellipse Canvas.Left="35" Canvas.Top="48" Width="4" Height="4" Fill="#ffffaa"/>
                            <Ellipse Canvas.Left="61" Canvas.Top="48" Width="4" Height="4" Fill="#ffffaa"/>
                        </Canvas>
                    </Viewbox>
                    
                    <StackPanel>
                        <TextBlock Text="ENVIRONMENT BUILDER" 
                                   FontSize="20" FontWeight="Bold" 
                                   Foreground="{StaticResource AccentGoldBrush}"/>
                        <TextBlock Text="Test Brutally - Build Your Level of Complexity" 
                                   FontSize="11" Foreground="{StaticResource TextMutedBrush}"/>
                    </StackPanel>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <Ellipse Width="12" Height="12" Margin="0,0,8,0">
                        <Ellipse.Style>
                            <Style TargetType="Ellipse">
                                <Setter Property="Fill" Value="#666666"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsConnected}" Value="True">
                                        <Setter Property="Fill" Value="#00ff88"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Ellipse.Style>
                    </Ellipse>
                    <TextBlock Text="{Binding IsConnected, Converter={x:Static local:BoolToConnectionConverter.Instance}, FallbackValue='Disconnected'}" 
                               Foreground="{StaticResource TextMutedBrush}" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Main Content with Tabs -->
        <TabControl Grid.Row="1" Background="Transparent" BorderThickness="0"
                    SelectedIndex="{Binding SelectedTabIndex}">
            
            <!-- ICE Settings Tab -->
            <TabItem Header="🔌 Connection">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="LDAP Connection Settings" Style="{StaticResource GoldLabel}" FontSize="16" Margin="0,0,0,15"/>
                        
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Server Address -->
                            <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,10,15">
                                <TextBlock Text="Server Address *" Style="{StaticResource GoldLabel}"/>
                                <TextBox Text="{Binding Configuration.Connection.ServerAddress, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{StaticResource DarkTextBox}"/>
                            </StackPanel>
                            
                            <!-- Port -->
                            <StackPanel Grid.Row="0" Grid.Column="1" Margin="10,0,0,15">
                                <TextBlock Text="Port *" Style="{StaticResource GoldLabel}"/>
                                <TextBox Text="{Binding Configuration.Connection.Port, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{StaticResource DarkTextBox}"/>
                            </StackPanel>
                            
                            <!-- Bind DN -->
                            <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,15">
                                <TextBlock Text="Bind DN (Username)" Style="{StaticResource GoldLabel}"/>
                                <TextBox Text="{Binding Configuration.Connection.BindDN, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{StaticResource DarkTextBox}"/>
                            </StackPanel>
                            
                            <!-- Password -->
                            <StackPanel Grid.Row="1" Grid.Column="1" Margin="10,0,0,15">
                                <TextBlock Text="Password" Style="{StaticResource GoldLabel}"/>
                                <PasswordBox x:Name="PasswordBox" 
                                             Background="#252545" Foreground="White" 
                                             BorderBrush="#3a3a5e" BorderThickness="1" Padding="8,5"/>
                            </StackPanel>
                            
                            <!-- Base DN -->
                            <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Margin="0,0,0,15">
                                <TextBlock Text="Base DN" Style="{StaticResource GoldLabel}"/>
                                <TextBox Text="{Binding Configuration.Connection.BaseDN, UpdateSourceTrigger=PropertyChanged}" 
                                         Style="{StaticResource DarkTextBox}"/>
                            </StackPanel>
                            
                            <!-- Options -->
                            <StackPanel Grid.Row="3" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,0,0,15">
                                <CheckBox Content="Use SSL/TLS" IsChecked="{Binding Configuration.Connection.UseSSL}"
                                          Foreground="{StaticResource TextLightBrush}" Margin="0,0,20,0"/>
                                <CheckBox Content="Anonymous Bind" IsChecked="{Binding Configuration.Connection.UseAnonymousBind}"
                                          Foreground="{StaticResource TextLightBrush}" Margin="0,0,20,0"/>
                                <CheckBox Content="Stop on Error" IsChecked="{Binding Configuration.Connection.StopOnError}"
                                          Foreground="{StaticResource TextLightBrush}"/>
                            </StackPanel>
                            
                            <!-- Test Connection Button -->
                            <Button Grid.Row="4" Grid.Column="0" Content="Test Connection" 
                                    Command="{Binding TestConnectionCommand}"
                                    Style="{StaticResource GoldButton}" Width="150" HorizontalAlignment="Left"/>
                        </Grid>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- User Configuration Tab -->
            <TabItem Header="👤 Users">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                        <TextBlock Text="User Configuration Sets" Style="{StaticResource GoldLabel}" FontSize="16" VerticalAlignment="Center"/>
                        <Button Content="+ Add User Set" Command="{Binding AddUserSetCommand}"
                                Style="{StaticResource GoldButton}" Margin="20,0,0,0"/>
                    </StackPanel>
                    
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding UserConfigs}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#16213e" CornerRadius="8" Padding="15" Margin="0,0,0,10">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            
                                            <!-- Set Name & Enable -->
                                            <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,10,10">
                                                <TextBlock Text="Set Name" Foreground="{StaticResource AccentGoldBrush}" FontSize="11"/>
                                                <TextBox Text="{Binding SetName, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}"/>
                                            </StackPanel>
                                            
                                            <!-- User Prefix -->
                                            <StackPanel Grid.Row="0" Grid.Column="1" Margin="5,0,5,10">
                                                <TextBlock Text="Username Prefix" Foreground="{StaticResource AccentGoldBrush}" FontSize="11"/>
                                                <TextBox Text="{Binding UserNamePrefix, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}"/>
                                            </StackPanel>
                                            
                                            <!-- Start/End Numbers -->
                                            <StackPanel Grid.Row="0" Grid.Column="2" Orientation="Horizontal" Margin="5,0,0,10">
                                                <StackPanel Margin="0,0,10,0">
                                                    <TextBlock Text="Start #" Foreground="{StaticResource AccentGoldBrush}" FontSize="11"/>
                                                    <TextBox Text="{Binding StartNumber}" Style="{StaticResource DarkTextBox}" Width="60"/>
                                                </StackPanel>
                                                <StackPanel>
                                                    <TextBlock Text="End #" Foreground="{StaticResource AccentGoldBrush}" FontSize="11"/>
                                                    <TextBox Text="{Binding EndNumber}" Style="{StaticResource DarkTextBox}" Width="60"/>
                                                </StackPanel>
                                            </StackPanel>
                                            
                                            <!-- Delete Button -->
                                            <Button Grid.Row="0" Grid.Column="3" Content="✕" 
                                                    Command="{Binding DataContext.RemoveUserSetCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                    CommandParameter="{Binding}"
                                                    Background="#aa3333" Foreground="White" Width="30" Height="30"
                                                    VerticalAlignment="Top" Margin="10,15,0,0"/>
                                            
                                            <!-- User Context -->
                                            <StackPanel Grid.Row="1" Grid.ColumnSpan="3" Margin="0,0,0,10">
                                                <TextBlock Text="User Context (Container DN)" Foreground="{StaticResource AccentGoldBrush}" FontSize="11"/>
                                                <TextBox Text="{Binding UserContext, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}"/>
                                            </StackPanel>
                                            
                                            <!-- Password and Domain -->
                                            <StackPanel Grid.Row="2" Grid.Column="0" Margin="0,0,10,0">
                                                <TextBlock Text="Default Password" Foreground="{StaticResource AccentGoldBrush}" FontSize="11"/>
                                                <TextBox Text="{Binding Password, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}"/>
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Row="2" Grid.Column="1" Margin="5,0,5,0">
                                                <TextBlock Text="Domain Name" Foreground="{StaticResource AccentGoldBrush}" FontSize="11"/>
                                                <TextBox Text="{Binding DomainName, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource DarkTextBox}"/>
                                            </StackPanel>
                                            
                                            <CheckBox Grid.Row="2" Grid.Column="2" Content="Enabled" 
                                                      IsChecked="{Binding IsEnabled}"
                                                      Foreground="{StaticResource TextLightBrush}" 
                                                      VerticalAlignment="Bottom" Margin="10,0,0,5"/>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            
            <!-- Output Settings Tab -->
            <TabItem Header="📄 Output">
                <StackPanel Margin="20">
                    <TextBlock Text="Output Settings" Style="{StaticResource GoldLabel}" FontSize="16" Margin="0,0,0,15"/>
                    
                    <StackPanel Margin="0,0,0,15">
                        <TextBlock Text="LDIF Export Path" Style="{StaticResource GoldLabel}"/>
                        <TextBox Text="{Binding Configuration.LdifExportPath, UpdateSourceTrigger=PropertyChanged}" 
                                 Style="{StaticResource DarkTextBox}"/>
                    </StackPanel>
                    
                    <StackPanel Margin="0,0,0,15">
                        <TextBlock Text="Log File Path" Style="{StaticResource GoldLabel}"/>
                        <TextBox Text="{Binding Configuration.LogFilePath, UpdateSourceTrigger=PropertyChanged}" 
                                 Style="{StaticResource DarkTextBox}"/>
                    </StackPanel>
                    
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <CheckBox Content="Write Only (Generate LDIF without importing)" 
                                  IsChecked="{Binding Configuration.WriteOnlyMode}"
                                  Foreground="{StaticResource TextLightBrush}" Margin="0,0,20,0"/>
                        <CheckBox Content="Delete Mode (Remove objects)" 
                                  IsChecked="{Binding Configuration.DeleteMode}"
                                  Foreground="{StaticResource TextLightBrush}"/>
                    </StackPanel>
                    
                    <Button Content="Generate LDIF Only" Command="{Binding GenerateLdifCommand}"
                            Style="{StaticResource GoldButton}" Width="180" HorizontalAlignment="Left"/>
                </StackPanel>
            </TabItem>
            
            <!-- Log Tab -->
            <TabItem Header="📋 Log">
                <Grid Margin="20">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Text="Operation Log" Style="{StaticResource GoldLabel}" FontSize="16" Margin="0,0,0,10"/>
                    
                    <ListBox Grid.Row="1" ItemsSource="{Binding LogMessages}"
                             Background="#16213e" Foreground="{StaticResource TextLightBrush}"
                             BorderBrush="#3a3a5e" BorderThickness="1"
                             FontFamily="Consolas" FontSize="12"/>
                </Grid>
            </TabItem>
        </TabControl>
        
        <!-- Progress Bar -->
        <ProgressBar Grid.Row="2" Height="4" Value="{Binding ProgressValue}" Maximum="100"
                     Background="#16213e" Foreground="{StaticResource AccentGoldBrush}" BorderThickness="0"/>
        
        <!-- Footer with Action Buttons -->
        <Border Grid.Row="3" Background="#16213e" Padding="20,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Status -->
                <TextBlock Text="{Binding StatusMessage}" Foreground="{StaticResource TextMutedBrush}" 
                           VerticalAlignment="Center"/>
                
                <!-- Action Buttons -->
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="Reset All" Command="{Binding ResetAllCommand}"
                            Background="#3a3a5e" Foreground="{StaticResource TextLightBrush}"
                            Padding="15,8" Margin="0,0,10,0" BorderThickness="0" Cursor="Hand"/>
                    <Button Content="Load Config" Command="{Binding LoadConfigurationCommand}"
                            Background="#3a3a5e" Foreground="{StaticResource TextLightBrush}"
                            Padding="15,8" Margin="0,0,10,0" BorderThickness="0" Cursor="Hand"/>
                    <Button Content="Save Config" Command="{Binding SaveConfigurationCommand}"
                            Background="#3a3a5e" Foreground="{StaticResource TextLightBrush}"
                            Padding="15,8" Margin="0,0,10,0" BorderThickness="0" Cursor="Hand"/>
                    <Button Content="⚔️ RUN UPDATE" Command="{Binding RunUpdateCommand}"
                            Style="{StaticResource GoldButton}" FontSize="14"
                            IsEnabled="{Binding IsProcessing, Converter={x:Static local:InverseBoolConverter.Instance}}"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
